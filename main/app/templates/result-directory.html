{% extends "base.html" %}

{% block content %}
<nav class="navbar navbar-dark bg-dark">
    <a class="navbar-brand" href="#">PDBEYC-3</a>
    <a href="/"><button class="btn btn-primary my-2 my-sm-0 ml-12" type="submit">Upload Singular Images</button></a>
</nav>
<br><br>
<div class="container">
    <div class="row">
        <div class="row">
            <h3>Pre Pre Matching</h3>
        </div>
        <div class="row">
            <!-- <form action="/reject" method="post"> -->
            {% for t in range(pre_len) %}
            
                <div class="col-md-4 p-3" id="pre_pre_{{loop.index}}">
                    <div class="card text-center">
                        <div class="card-header">
                        Image set {{t}}
                        </div>
                        <div class="row card-body">
                            <div class="col-sm text-center">
                                <img class="img-fluid" height="150" width="150" src="static{{ pre_match[1][t] }}">    
                            </div>
                            <div class="col-sm text-center">
                                <img class="img-fluid" height="150" width="150" src="static/{{ pre_match[2][t] }}">    
                            </div>
                        </div>
                        <div class="card-footer text-muted">
                        Distance = {{ ((0.5/(0.5+pre_match[0][t]))*100) }}%
                        <br>
                        </div>
                        <div class="card-footer text-muted">
                            <button type="submit" onclick="reject({{loop.index}},'#pre_pre_','{{pre_match[1][t]}}')" class="btn btn-outline-danger d-inline-block .float-left">Reject</button>
                            <button type="submit" onclick="accept({{loop.index}},'#pre_pre_','{{pre_match[1][t]}}')" class="btn btn-outline-success d-inline-block .float-right">Accept</button>
                        </div>
                    </div>
                </div>
            
            {% endfor %}
            <!-- </form> -->
        </div>
    </div>

    <hr>

    <div class="row">
        <div class="row">
            <h3>Post Post Matching</h3>
        </div>
        <div class="row">
            {% for t in range(post_len) %}
            <div class="col-md-4 p-3" id="post_post_{{loop.index}}">
                    <div class="card text-center">
                        <div class="card-header">
                            Image set {{t}}
                        </div>
                        <div class="row card-body">
                            <div class="col-sm text-center">
                                <img class="img-fluid" height="150" width="150" src="static{{ post_match[1][t] }}">    
                            </div>
                            <div class="col-sm text-center">
                                <img class="img-fluid" height="150" width="150" src="static/{{ post_match[2][t] }}">    
                            </div>
                        </div>
                        <div class="card-footer text-muted">
                                Distance = {{ ((0.5/(0.5+post_match[0][t]))*100) }}%
                        </div>
                        <div class="card-footer text-muted">
                            <button type="button" onclick="reject({{loop.index}},{{post_match}},'#post_post_')" class="btn btn-outline-danger d-inline-block .float-left">Reject</button>
                            <button type="button" onclick="reject({{loop.index}},{{post_match}},'#post_post_')" class="btn btn-outline-success d-inline-block .float-right">Accept</button>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>

    <hr>

    <div class="row">
        <div class="row">
            <h4>Pre Post Matching</h4>
        </div>
        <div class="row">
            {% for t in range(match_len) %}
            <div class="col-md-4 p-3" id="pre_post_{{loop.index}}">
                <div class="card text-center">
                    <div class="card-header">
                        Image set {{t}}
                    </div>
                    <div class="row card-body">
                        <div class="col-sm text-center">
                            <img class="img-fluid" height="150" width="150" src="static{{ match[1][t] }}">    
                        </div>
                        <div class="col-sm text-center">
                            <img class="img-fluid" height="150" width="150" src="static{{ match[2][t] }}">    
                        </div>
                    </div>
                    <div class="card-footer text-muted">
                            Distance = {{ ((0.5/(0.5+match[0][t]))*100) }}%
                    </div>
                    <div class="card-footer text-muted">
                        <button type="button" onclick="reject({{loop.index}},{{pre_match}},'#pre_post_')" class="btn btn-outline-danger d-inline-block .float-left">Reject</button>
                        <button type="button" onclick="reject({{loop.index}},{{pre_match}},'#pre_post_')" class="btn btn-outline-success d-inline-block .float-right">Accept</button>
                    </div>
                </div>
            </div>
            
            {% endfor %}
        </div>
    </div>

    <!-- <button type="button" onclick="cont()" class="btn btn-outline-success d-inline-block .float-right">Continue</button> -->

</div>

<script>
    
    var list = []
    var idx
    var demo = 1

    var socket = io.connect('http://0.0.0.0:5000/');

    $(document).ready(function(){
        

        socket.on('connect',function(){
            socket.emit('connection', {data: "Connection Checking"});
        });
    })
    
    function reject(index, id, img)
    {
        $("div").remove(id+index)
        idx = index
        socket.emit('reject',img)
    }

    function accept(index, id, img)
    {
        $("div").remove(id+index)
        idx = index
        socket.emit('accept',img)
    }

</script>


{% endblock %}